<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dizi Oynatıcı</title>
    <style>
        body {
            background: #121212;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        .loading-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            flex-direction: column;
        }
        .series-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px;
        }
        .series-card {
            background: #1e1e1e;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
        }
        .series-poster {
            width: 100%;
            height: 280px;
            object-fit: cover;
        }
        .retry-btn {
            margin-top: 20px;
            padding: 10px 20px;
            background: #6a1b9a;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="loading-container" id="loadingScreen">
        <div class="loading-text">Diziler yükleniyor...</div>
        <button class="retry-btn" id="retryBtn" style="display:none;">Tekrar Dene</button>
    </div>

    <div class="series-grid" id="seriesGrid"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loadingScreen = document.getElementById('loadingScreen');
            const loadingText = loadingScreen.querySelector('.loading-text');
            const retryBtn = document.getElementById('retryBtn');
            const seriesGrid = document.getElementById('seriesGrid');
            
            // M3U URL'si
            const M3U_URL = 'https://raw.githubusercontent.com/ademolalookman/ademola/refs/heads/main/dizifun.m3u';
            
            // Yeniden deneme butonu
            retryBtn.addEventListener('click', loadM3UData);
            
            // M3U yükleme fonksiyonu
            function loadM3UData() {
                loadingText.textContent = "Diziler yükleniyor...";
                retryBtn.style.display = 'none';
                
                fetch(M3U_URL)
                    .then(response => {
                        if (!response.ok) throw new Error('Sunucu hatası: ' + response.status);
                        return response.text();
                    })
                    .then(parseM3U)
                    .catch(handleError);
            }
            
            // M3U parse fonksiyonu
            function parseM3U(data) {
                const lines = data.split('\n');
                let currentItem = {};
                let hasValidData = false;
                
                for (let i = 0; i < lines.length; i++) {
                    const line = lines[i].trim();
                    
                    if (line.startsWith('#EXTINF:')) {
                        currentItem = {};
                        const info = line.substring(8).split(',');
                        currentItem.name = info[1] || 'İsimsiz Dizi';
                        
                        // URL'yi al (bir sonraki satır)
                        currentItem.url = lines[++i]?.trim();
                        
                        if (currentItem.url) {
                            addSeriesCard(currentItem);
                            hasValidData = true;
                        }
                    }
                }
                
                if (hasValidData) {
                    loadingScreen.style.display = 'none';
                } else {
                    throw new Error('Geçerli dizi verisi bulunamadı');
                }
            }
            
            // Dizi kartı ekleme
            function addSeriesCard(series) {
                const card = document.createElement('div');
                card.className = 'series-card';
                card.innerHTML = `
                    <img src="https://via.placeholder.com/200x280/6a1b9a/ffffff?text=${encodeURIComponent(series.name.substring(0, 15))}" 
                         class="series-poster"
                         alt="${series.name}">
                    <div style="padding:10px;">
                        <h3 style="margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${series.name}</h3>
                    </div>
                `;
                seriesGrid.appendChild(card);
            }
            
            // Hata yönetimi
            function handleError(error) {
                console.error('Hata:', error);
                loadingText.innerHTML = `Diziler yüklenirken hata oluştu:<br><small>${error.message}</small>`;
                retryBtn.style.display = 'block';
            }
            
            // İlk yükleme
            loadM3UData();
        });
    </script>
</body>
</html>